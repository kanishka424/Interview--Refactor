

$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$2.INTRODUCTION$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$


TIME 03.56 IMAGE -WHAT WE WILL DO IN COURSE THE SYSTEM


$$$$$$$$$$$$$$$$$$$$$$3. Introduction to OAuth 2$$$$$$$$$$$$$$$$$$$$$$$


OAuth=Open+Authorization

OAuth and OAuth 2.0 has lots od differences 
today ost use OAuth 2.0

OAuth 2.0
Industry standard protocol
PRovides different authorization flows to different applications
e.g-there i flow for mobile and there is a different flow for web applications


NOT ONE PARTICUALR WAY OF AUTHORIZATION THERE ARE SEVERAL WAYS OF AUTHORIZATION



OAUTH 2 is an authorization flow which access data and perform some operations on that data on uer behalf


Time 01.28 - EXAMPLE
as a user you can grant in another application access to your data stored in another  application



Exampl- user uses an application that is a photo app which shows FB photos
Unless the application has user permisiion it wont be accessing the Photos stored in FB
beacuase fb wont allow
this is where AUTHORIZATION FRAMEWORK HELPS!!!

AUTHORIZATION FRAMEWORK CAN HELP THE USER TO GRANT AUTHORIZATION TO 3RD PARTY APPLICATIONS ,LIKE THE MOBILE APP WE TALKS HERE,FOR EXAMPLE TO ACCESS USERS DATA ON FB
AND TO GIVE THIS MOBILE APP THE ACCESS TO THEIR DATA USER DO NOT HAVE TO GIVE THE MOBILE APP THEIR "FB" USERNAME AND PW
THERE IS A SPECIFIC FLOW THAT YOU CAN DO TO IMPLEMENT IT

QUETION -DIFFERENCE BETWEEEN SSO AND OAUTH??



OAuth is called delegated authorization framework because of above fact
GGOD THING-WITH OAUTH 3RD PARTY APPLICATION CAN HAVE ONLY LIMITED ACCESS TO USER DATA,ONLY WHICH IS NECESSARY,NOT ALL THE DATA.sO IT CAN PERORM LIMITED SET OF OPERATION USERS BEHALF ON DATA


TIME 3.10 HOW WE LOGGING TO SOCIAL NETWORKS USE USER DATA IN EARLIER DAYS BEFORE OAUTH



TIME IMAGE 03.51

A LIST OF SOCIAL NETWORKS WOULD APPEAR AND YOU WILL SELECT ONE OF THOSE AND PROVIDE USERNAM AND PW OF THAT PARTICULAR NEETWORK SO THE THIRD PARTY APP CAN SEND USERNAME AND PW ON YOUR BEHALF TO THE SOCIAL MEDAIA YOU CHOOSE
SOMETHIME THE WEBSITE MIGHT STROE UERNAM AND PW SO THEY CAN ACCESS THE DATA AT ANYTIME
VERY INSECURE!!!!IT CAN ACCESS ANY DATA!!!

ALSO WE ARE NOT SURE HOW SECURE THE 3RD PART APP STORES UN AND PW IT CAN BE VULNERABLE

OAuth WAS DWSIGNED WITH THIS!!!

INSTEAD OF GIVING UN AND PW THE USER WOULD BE DIRECTED TO A GOOGLE LOGIN PAGE
WHICH WAS DEIGNED AND CREATED BY GOOGLE THE 3RD PART APP WONT GET TO KNOW GOOGLE PW AND UN
IF THE LOGIN IS SUCCESFUL THE AUTHORIZATION SERVER(***GOOGLES AUTHORIZATION SERVER)
IT WILL ASK USER IF THEY WONT TO ALLOW THE APPLICATION TO VIEW THE DATA IT RQUESTS FOR
IF USER PRSSS YE THEN IT WILL PASS A SPECIAL "ACCESS TOKEN" TO 3RD PARTY APP TO VIEW PHOTOS ONLY!!
tIME -06.52 -IMAGE

QUESTION -WHAT IF SOME MALICIOU APP USED GOOGLE LIKE LOGIN PAGE AND ASKED TO ENTER UN AND PW


THIS IS MUCH SECURE BECAUS USER DOES NOT GIVE UN AND PW TO  3RD PARTY APPLICATION!
SO IT CANT STORE IT AND IT CAN 'T HAVE UNLIMITED ACEES TO DATA
IT CAN ONLY HAVE ACCESS TO LIMITED AND FOR LIMITED TIME!


SINCE USER HAS ONLY GIVEN ACCESS TO PHOTOS READ ONLY APP CANT HAVE ACCES TO GMAIL DATA  ,GOOGLE DOCS ,ETC....

THIS IS THE HIGH LEVEL VIEW!



$$$$$$$$$$$$$$$$$$$$$$$$$$$4.UER ROLES$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

RESOUCE OWNER-USER OWNS THE DATA  AND CAN GRANT 
CLIENT-APPLICATION 
RESOURCE SERVER -HOST INFO (GOOGLE,OWN SERVER,ETC..)) CAN BE ACCESED BY AN API
IF YOU BUILT MICRO SERVICES EACH MS IS A SEPERATE RESOURCE OWNER-USER
IF ITS A MONOLITH THERE IS ONLY ONE RESOURCE SERVER


AUTHORIZATION SERVER-ISSUES ACCESS TOKEN TO CLEINT AFTER AUTHENTICATING RESOURCE OWNER AND 

ALL LIKE GOOGLE ,TWITTER,MICROOFT HAVE THEIR OWN AUTHORIZATION SERVER
WE AS DEVELOPERS CAN IMPLEMENT  FUNCTIONALITY TO ALLOWS USER TO LOGIN TO OUR APP AS BY AUTHENTICATION BY FB ,TWIITER,GOOGLE
ALSO WE CAN CREATE OUR OWN AUTHORIZATION SERVERS 
E.G-1.SPRING AUTHORIZATION SERVER
2.KEY LOCK AUTHORIZATION SERVER 
THAT WE CAN RUN IN A LOCAL CONTAINER IN SPRING BOOT APPLICATION

THERE ARE OTHER AUTORIZATION SERVERS THAT CAN RUN AS STANDALONE  ERVER RUN AS OUR STANDALONE APPLICATION SERVER IN OUR OWN HW 
ALSO AUTHORIZATION SERVER   RUNS ON CLOUS
E.G-AWS COGNITO,MICROOFT IDENTITY PALTFORM,OKTA

TIME 03.10 IMAGE HIGHLEVE PICTURE



$$$$$$$$$$$$$$$$$$$$5.5. Current State of OAuth 2.0 in Spring Security 5$$$$$$$$$$$$


"SPRING SECURITY OAUTH PROJEC"currently support large portion of OAUth pecification

provides following in ONLY IN ONE INGLE PROJECT
1.client support
2.reource server 
3.AUTHORIZATION server


SO POPULAR THOUSANDS OF PROJEDCTS ARE POWERED BY PRING SECURITY OAUTH

IN 2018 OLDER OAUTH PROJECT WAS DEPRECATED STILL SUPPORTED BUT IN MAINTENCE
SEE THE GITHUB OF SPRING SECURITY OAUTH PROJECT
WILL BE SUPPORTED TILL MAY 2021 END OF LIFE


THIS IS ABOUT NEW OAUTH 2 SPRING SECURITY

FOR THE NEW SPRING SECURITY OAUTH PROJECT FOLLOWING ARE AVAILABLE

1.CLIENT SUPORT 
2.RESOURCE SERVER


BUT FOLLOWING IS NOT AVAILABLE//NOW IT MUST BE
AUTHORIZATION SERVER 
SO SINCE THE AUTHORIZATION SERVER IS NOT STILL AVAILBALE WE  WILL USE "KEY CLOACK
SERVER"  INSTEAD
IT CAN BE RUN ON YOUR LOCAL MACHINE
IT IS OPEN SOURCE /FREE
SUPPORTS ALL OF  OAUTH FLOWS

"KEY CLOACK
SERVER"  IS MUCH FRIENDLY WITH SPRING "RESOURCE SERVER"//WHICH IS IMPLEMENTED ALREADY


$$$$$$$$$$$$$$$$$$$$$$$$$$$$$6. OAuth 2.0 Client Types$$$$$$$$$$$$$$$$$$$$$$$$$$$
TWO DIFFERENT CLIENT TYPES
BASED ON THEIR ABILITY TO AUTHENTICATE SECUERLY WITH AUTHENTICATED  SERVER 


LET SEE THE OAUTH FLOW ONE MORE TIME (IMAGE TIME 00.32)
JUST LISTEN TILL 1.15

IT CAN BE DIFFERENT CLIENT APPS
1.NATIVE APPS ON USER DEVEICE
2.SECURE APP RUNNING ON SERVER
3.SINGLE PAGE  BROWSER BASED APP

THIS CLIENT APPS WILL SEND HTTP REQUEST TO AN AUTHORIZATION SERVERS
AND THE CLIENT APP TO BE COMMUICATING WITH AUTHORIZATION SERVER IT HAS TO REGISTER WITH "AUTHORIZATIO SERVER" AN DGET IT S CLIENT ID AND SECRET KEY INORDER TO
SO AUTHORIZTAION SEVERE AND CLIENT CAN COMMUNICATE SECUERLY WITH EACH OTHER 


SO WHEN COMMUNICATING WITH AUTHORIZATION SERVER THE CLIENT APPLICATION WILL NEED TO SECURELY CLIENT APP WILL NEED TO PROVIDE CLIENT ID TO AUTHORIZATION SERVER
SO AUTHORIZATION SERVER CAN RECOGNIZED THE CLIENT APPLICATION


SOMETIMES THE CLIENT MAY NEED TO PROVIDE THE AUTHORIZATION SERVER WITH A SECRET KEY
BUT NOT ALL CLIENT APPLICATION CAN SECUERLY STORE AN SECRET KEY IN THERE SIDE
AND THIS IS WHY CLIENTS ARE GROUPED INTO TWO DIFFERENT CLIENTS
1.CONFIDENTIAL CLIENT
2.PUBLIC CIENT






1.CONFIDENTIAL CLIENT-CAN KEEP CLIENT SECRET SAFE ON THEIR SIDE
E.G-SECURE APP RUNNING ON SERVER
SO THEY REGISTER WITH AUTHORIZATIO SERVER AS CONFIDENTIAL CLIENT THUS ISSUED A SECRET KEY
THEY CAN SECURLY COMMUNICATE WITH AUTHORIZATION SERVER WITH CLIENT ID AND CLIENT SECRET KEY
THEY CAN SECURLY COMMUNICATE WITH AUTHORIZATION SERVER WITH CLIENT ID AND CLIENT SECRET KEY

2.PUBLIC CIENT
CAN NO TKEEP THE CLIENT ID AND THE CLIENT SECRET SAFE

E.G-NATIVE APPS ON DEVICE
SINGLE PAGE BROWSER BASED APP
DESKTOP APP

IF THIS CLIENT APPS CAN BE DECOMPILED AND CODE CAN BE VIEWED NO GURANTEE THAT 
CONFIDENTIALITY IT IS CALLED A PUBLIC CLIENT

IF PUBLIC CLIENTS ARE REGISTERED WITH AUTHORIZATION SERVER THEN A SECRET KEY MAY NOT EVEN ISSUED
BECUAE PUBLIC CLIENTS CAN NOT GURANTEE ITS CONFIDENTIALITY
 (TIME 4.16 IMAGE)



$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$7. OAuth Access Token$$$$$$$$$$$$$$$$$$$$$$$$

oNCE USER SUCCESFULLY authenticated with authorization server and give permission to access data  application(client) will be issued an access token from authorization server
then client will pass the acess token to where ever its need to accees resource data (here it is the API gateway)
then the resource server will send the access token it recevied to authorization server for verificatin and acces token is not fake and it is valid
if the authorizaation server confirms access token  is valid   then the resource server can let the request proceed(TIME  image 01.02)without asking user to  provid credentials
and because of this the ACCESS TOKEN MUST BE CONSIDERED AS SENETIVE INFO BY CLIENT APPLICATION
CLIENT APPLICATION UST STORE ACCESS TOKEN AND IT MUST BE STROED IN A SECURE LOCATION
****AND WHEN ACCESSS TOKEN IS IN USE IN A HTTP REAQUEST THIS MUST BE IN A SECURE SSL
CONNECTION

VERY IMORTANT TO KEEP ACCESS TOKEN SECURE SO IT CANT BE STOLLEN
THE ONLY POINT TO ALLOW ACCESS TOKEN ACCESS ARE
AUTHENTICATION SERVER
RESOURCE SERVER
AND CLIENT

**THERE ARE DIFFERENT TYPE SOF ACCE TOKENS
THE TOKEN MAY DENOTE AN IDENTIFIER UED TO RETRIEVE THE AUTHORIZATION INFORMATION OR MAY SELF -CONTAIN THE AUTHORIZATION INFORMATION IN A VERIFIBLE MANNER(I.E A TOKEN STRING CONSITING OF SOME   DATA AND A SIGNATURE)

1.IDENTIFY TYPESELF
2.SELF-CONTAIN THE AUTHORIZATION INFORMATION

1.IDENTIFY TYPESELF-
AN ALPAH NUMERIC 
2.SELF-CONTAIN THE AUTHORIZATION INFORMATION-MUCH LONGER ,A JSON OBJECT-BASE 64 ENCODE,
CAN ACCES SEE USING ONLINE BASE64 DECODERS
SO THES TYPE MUST NEVER EVER CONTAIN SENSITVE INFO SUCH AS PAYMENT KEY,CREDENTIALS,ETC.....!!!!!!!!!!!!!!


TIME 4.26 IMAGE IDENTIFY TYPESELF
IDENTIFY TYPESELF DOESNT CONTAIN ANY AUTHORIZATION DETAILS
IT IS USED TO LOOKUP THE DATA TATH IS ASSOCIATED WITH TOKEN IN DB

TIME -04.36 LISTEN
WE CAN SEE THE SCOPE OR UP TO WAHT EXTEND USER HA AUTHORIZED ACCESED
WE CAN SEE WHEN THE ACCESS TOKEN EXPIRES
AND IF WE NEED TO PULL UP USER DETAILS WE HAVE USER IDENTIFIER
THSI IS AN EXAMPLE THERE CAN BE MANY ASSOCIATED DATA TYPES !!!


TIME 5.12
SELF-CONTAINED ACESS TOKE TYPES

JSON OBJECT THAT IS BASE 64 ENCODED
THREE PARTS
HEADER
PAYLOAD
SIGNATURE


USING ONLINE TOOL LIKE JWT.IO

THE HEADER SECTION TELS HOW TO READ TOKEN THE TYPE OF TOEN AND THE ALGORITHM USED  TO ENCRYPT


PAYLOAD CONTAINS INFO AND DATA THAT NEED TO BE RRANSFERE BETWEEN APPS










now client can access users data on resource erver without 



time  0.47


$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$8. OAuth2 and OpenID Connect (OIDC)$$$$$$$$$$$$$$$$$$$$$$$$$$$$$


OPENID CONNECT-AS AN ADDITIONAL LAYER OF DATA THAT WILL PROVIDE MOORE USER DATA AFTER RECEVING ACCES TOKEN FROM AUTHORIZATION SERVER


COMES AS AN ADDITIONAL LAYER ON AUTHOTHRIZATION SERVER/OAUTH 2 AND IT IS AN IDENTTIY LAYER
ITS AN IDENTITY LAYER THAT CAN PROVIDECLIENT  ADDITIONAL IDENTITY INFORMATION ABOUT USER
ALSO CALLED AN IDENTITY PROVIDDRE
TIME IMAGE 0.49


WITH OPENID AT THE MOMENT ACESS TOKEN IS GIVEN AN ID TOKEN WOULD BE PROVIDED TO THE CLIENT AS WELL
TIME 01.40 IMAGE


ID TOKEN PROVIDES USER ID INFO AND CLIENT CAN USE THAT ID TOKEN TO EXTRACT INFO FROM BASIC INFROMATION ABOUT  AUTHENTICATED USER
NOW CLIENT HAS "ID TIKEN" AND "ACCESS TOKEN"
ID TOKEN -CAN BE USED TO SEE IF THE USER IS THE UER WHO THEY CLAIM TO BE 
ACESS TOKEN -CHECK IF THE USER IS ALLOWED TO ACCESS THE REQUETED RESOURCE


TIME 02.15 IMAGE -EXAMPLE OF ID TIKEN(TIME 2.15SHOWS WITHOUT ID TOKEN" 2.19 SHOWS WITH ID TOKEN


























$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$7. OAuth Access Token$$$$$$$$$$$$$$$$$$$$$$$$











































 











































