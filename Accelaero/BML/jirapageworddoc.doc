<!DOCTYPE html>
<html>
<head>
    <title>[#PAY-1548] Flyme payment gateway integration </title>
    <meta http-equiv="Content-Type" Content="application/vnd.ms-word; charset=UTF-8">
        <style type="text/css">

.tableBorder, .grid
{
    background-color: #fff;
    width: 100%;
    border-collapse: collapse;
}

.tableBorder td, .grid td
{
    vertical-align: top;
    padding: 2px;
    border: 1px solid #ccc;
}

.noPadding
{
    padding: 0 !important;
}

h3 .subText
{
    font-size: 60%;
    font-weight: normal;
}

.tabLabel
{
    font-weight: bold;
    border: 1px solid #ccc;
    border-bottom:none;
    padding: 2px;
    display: inline;
}

td.blank
{
    padding: 0;
    margin: 0;
}

.blank td
{
    border: none;
}

#descriptionArea
{
    margin: 0;
    padding: 2px;
    border: 1px solid #ccc;
}

hr
{
    border-top:1px solid #aaa;
}

hr.fullcontent
{
  height: 15px;
  padding: 10px 0;
  background: #fff url('https://jiraisa.atlassian.net/images/icons/hr.gif') no-repeat scroll center;
}

</style>

</head>
<body>

<table class="tableBorder" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
                            <h3 class="formtitle">
                        [PAY-1548]&nbsp;<a href="https://jiraisa.atlassian.net/browse/PAY-1548">Flyme payment gateway integration </a>
            <span class="subText">
               Created: 27/Jun/22                   &nbsp;Updated: 13/Oct/22

                                            </span>
            </h3>
        </td>
    </tr>
    <tr>
        <td width="20%"><b>Status:</b></td>
        <td width="80%">In Testing</td>
    </tr>
    <tr>
        <td width="20%"><b>Project:</b></td>
        <td width="80%"><a href="https://jiraisa.atlassian.net/secure/BrowseProject.jspa?id=11031">revamp:aeroPAY</a></td>
    </tr>

        <tr>
            <td><b>Components:</b></td>
            <td>
                            None
                </td>
    </tr>
    

        <tr>
            <td><b>Affects versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    

        <tr>
            <td><b>Fix versions:</b></td>
            <td>
                            None
                </td>
    </tr>
    
    </table>

<br />
<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td bgcolor="#f0f0f0" valign="top" width="20%">
            <b>Type:</b>
        </td>
        <td bgcolor="#ffffff" valign="top"  width="30%" >
            Story
        </td>

                    <td bgcolor="#f0f0f0">
                <b>Priority:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap>
                Medium
            </td>
            </tr>
    <tr>
                        <td bgcolor="#f0f0f0" valign="top" width="20%">
                <b>Reporter:</b>
            </td>
            <td bgcolor="#ffffff" valign="top"  width="30%" >
                                        
                
        
            <a class="user-hover" rel="5c3dcd4bc5484b691dd399c5"
                id="word_reporter_5c3dcd4bc5484b691dd399c5"
                href="https://jiraisa.atlassian.net/secure/ViewProfile.jspa?accountId=5c3dcd4bc5484b691dd399c5">
                    Pradeep Karunanayaka
                </a>

                            </td>
        
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Assignee:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" nowrap  width="30%" >
                                        
                
        
            <a class="user-hover" rel="5cbdb3063d24270e75a8eb8b"
                id="word_assignee_5cbdb3063d24270e75a8eb8b"
                href="https://jiraisa.atlassian.net/secure/ViewProfile.jspa?accountId=5cbdb3063d24270e75a8eb8b">
                    mkarthy
                </a>

                            </td>
            </tr>
    	<tr>
		<td bgcolor="#f0f0f0" width="20%">
			<b>Resolution:</b>
		</td>
		<td bgcolor="#ffffff" valign="top" width="30%" nowrap>
            				Unresolved
                    </td>
                    <td bgcolor="#f0f0f0" width="20%">
                <b>Votes:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" width="30%" nowrap>
                0
            </td>
        
    </tr>
    
        <tr>
        <td bgcolor="#f0f0f0" width="20%">
            <b>Labels:</b>
        </td>
        <td id="labels-91879-value" class="value" bgcolor="#ffffff" valign="top" colspan="3" nowrap>
                            None
                    </td>
    </tr>
    
    	<tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Σ Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap>
                            1 day, 1 hour
                    </td>
        		<td bgcolor="#f0f0f0" width="20%"><b>Remaining Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap>
                            0 minutes
            		</td>
    </tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Σ Time Spent:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap>
                            7 weeks, 1 day, 6 hours, 15 minutes
                    </td>
                <td bgcolor="#f0f0f0" width="20%"><b>Time Spent:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap>
                            3 weeks, 2 days, 6 hours, 15 minutes
            		</td>
	</tr>
    <tr>
                <td bgcolor="#f0f0f0" width="20%"><b>Σ Original Estimate:</b></td>
        <td bgcolor="#ffffff" valign="top" nowrap>
                            1 day, 1 hour
                    </td>
                <td bgcolor="#f0f0f0" width="20%"><b>Original estimate:</b></td>
		<td bgcolor="#ffffff" valign="top" nowrap>
                            Not Specified
            		</td>
    </tr>
    
    </table>



    <br />

    	<table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            

                <tr>
            <td bgcolor="#f0f0f0" width=20% valign=top>
                <b>Attachments:</b>
            </td>
            <td bgcolor="#ffffff" valign="top">
                                    <img src="https://jiraisa.atlassian.net/images/icons/attach/image.gif" height="16" width="16" border="0" alt="PNG File">
                    image-20220808-104115.png &nbsp;&nbsp;&nbsp;
                                    <img src="https://jiraisa.atlassian.net/images/icons/attach/image.gif" height="16" width="16" border="0" alt="PNG File">
                    image-20220808-104125.png &nbsp;&nbsp;&nbsp;
                            </td>
        </tr>
        
            <tr>
            <td bgcolor="#f0f0f0" width="20%" valign="top">
                <b>Issue links:</b>
            </td>
            <td bgcolor="#ffffff" valign="top" class="noPadding">
                <table cellpadding="0" cellspacing="0" border="0" width="100%" class="blank">
                                            <tr>
                            <td colspan="4" bgcolor="#f0f0f0">
                                <b>Relates</b><br/>
                            </td>
                        </tr>
                                    <tr>
            <td>
                relates to
            </td>
            <td>
                <a href="https://jiraisa.atlassian.net/browse/ASPPI-4879">
                     ASPPI-4879                 </a>
            </td>
            <td>
                Flyme payment gateway integration  - ...
            </td>
            <td>
                In Progress
            </td>
        </tr>
                                        <tr>
            <td>
                relates to
            </td>
            <td>
                <a href="https://jiraisa.atlassian.net/browse/PAY-1827">
                     <strike>PAY-1827</strike>                 </a>
            </td>
            <td>
                Fly Me - IBE - When user trying to ma...
            </td>
            <td>
                Done
            </td>
        </tr>
            <tr>
            <td>
                relates to
            </td>
            <td>
                <a href="https://jiraisa.atlassian.net/browse/PAY-1830">
                     <strike>PAY-1830</strike>                 </a>
            </td>
            <td>
                FLY ME - IBE - Observation - User doe...
            </td>
            <td>
                Done
            </td>
        </tr>
            <tr>
            <td>
                relates to
            </td>
            <td>
                <a href="https://jiraisa.atlassian.net/browse/PAY-1828">
                     <strike>PAY-1828</strike>                 </a>
            </td>
            <td>
                Observation - IBE - Fly Me - When a r...
            </td>
            <td>
                Done
            </td>
        </tr>
            <tr>
            <td>
                relates to
            </td>
            <td>
                <a href="https://jiraisa.atlassian.net/browse/PAY-1829">
                     PAY-1829                 </a>
            </td>
            <td>
                Observation - IBE - Fly Me - When a r...
            </td>
            <td>
                Ready for testing
            </td>
        </tr>
                                        </table>
            </td>
        </tr>
    


<tr><td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sub-tasks:</b></td>
    <td bgcolor="#ffffff" valign="top">
        <table class="grid" cellpadding="0" cellspacing="0" border="0" width="100%">
            <tr bgcolor="#f0f0f0">
                <td>
                    <b>Key</b><br/>
                </td>
                <td>
                    <b>Summary</b><br/>
                </td>
                <td>
                    <b>Type</b><br/>
                </td>
                <td>
                    <b>Status</b><br/>
                </td>
                <td>
                    <b>Assignee</b><br/>
                </td>
            </tr>
                            <tr>
                    <td>
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1549">PAY-1549</a>
                    </td>
                    <td valign="top" width="25%">
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1549">DB changes</a>
                    </td>
                    <td>
                        Sub task
                    </td>
                    <td>
                        Done
                    </td>
                    <td>
                                                     Kanishka malpana  &nbsp;
                                            </td>
                </tr>
                            <tr>
                    <td>
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1550">PAY-1550</a>
                    </td>
                    <td valign="top" width="25%">
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1550">Implementation - setup new payment ga...</a>
                    </td>
                    <td>
                        Sub task
                    </td>
                    <td>
                        Done
                    </td>
                    <td>
                                                     Kanishka malpana  &nbsp;
                                            </td>
                </tr>
                            <tr>
                    <td>
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1551">PAY-1551</a>
                    </td>
                    <td valign="top" width="25%">
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1551">implementation - process the payment ...</a>
                    </td>
                    <td>
                        Sub task
                    </td>
                    <td>
                        Done
                    </td>
                    <td>
                                                     Kanishka malpana  &nbsp;
                                            </td>
                </tr>
                            <tr>
                    <td>
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1552">PAY-1552</a>
                    </td>
                    <td valign="top" width="25%">
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1552">Deploy in QA environment </a>
                    </td>
                    <td>
                        Sub task
                    </td>
                    <td>
                        Done
                    </td>
                    <td>
                                                     Kanishka malpana  &nbsp;
                                            </td>
                </tr>
                            <tr>
                    <td>
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1586">PAY-1586</a>
                    </td>
                    <td valign="top" width="25%">
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1586">Build failure and configuration issue...</a>
                    </td>
                    <td>
                        Sub task
                    </td>
                    <td>
                        Done
                    </td>
                    <td>
                                                     Pradeep Karunanayaka  &nbsp;
                                            </td>
                </tr>
                            <tr>
                    <td>
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1660">PAY-1660</a>
                    </td>
                    <td valign="top" width="25%">
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1660">Review the implementation - 22 July </a>
                    </td>
                    <td>
                        Sub task
                    </td>
                    <td>
                        Done
                    </td>
                    <td>
                                                     Pradeep Karunanayaka  &nbsp;
                                            </td>
                </tr>
                            <tr>
                    <td>
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1668">PAY-1668</a>
                    </td>
                    <td valign="top" width="25%">
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1668">Review the implementation - 25 July</a>
                    </td>
                    <td>
                        Sub task
                    </td>
                    <td>
                        Done
                    </td>
                    <td>
                                                     Pradeep Karunanayaka  &nbsp;
                                            </td>
                </tr>
                            <tr>
                    <td>
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1749">PAY-1749</a>
                    </td>
                    <td valign="top" width="25%">
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1749">Review and validation - 01 Aug </a>
                    </td>
                    <td>
                        Sub task
                    </td>
                    <td>
                        Done
                    </td>
                    <td>
                                                     &nbsp;
                                            </td>
                </tr>
                            <tr>
                    <td>
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1750">PAY-1750</a>
                    </td>
                    <td valign="top" width="25%">
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1750">Review and validation - 02 Aug </a>
                    </td>
                    <td>
                        Sub task
                    </td>
                    <td>
                        Done
                    </td>
                    <td>
                                                     &nbsp;
                                            </td>
                </tr>
                            <tr>
                    <td>
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1752">PAY-1752</a>
                    </td>
                    <td valign="top" width="25%">
                        <a href="https://jiraisa.atlassian.net/browse/PAY-1752">Review and validation - 04 Aug</a>
                    </td>
                    <td>
                        Sub task
                    </td>
                    <td>
                        Done
                    </td>
                    <td>
                                                     &nbsp;
                                            </td>
                </tr>
                            <tr>
                    <td>
                        <a href="https://jiraisa.atlassian.net/browse/PAY-2064">PAY-2064</a>
                    </td>
                    <td valign="top" width="25%">
                        <a href="https://jiraisa.atlassian.net/browse/PAY-2064">Logs enhancement </a>
                    </td>
                    <td>
                        Sub task
                    </td>
                    <td>
                        In Progress
                    </td>
                    <td>
                                                     Kanishka malpana  &nbsp;
                                            </td>
                </tr>
                    </table>
    </td>
</tr>

                        <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Epic Link:</b></td>
                <td id="customfield_10002-91879-value" class="value" bgcolor="#ffffff" width="80%">
    <a class="aui-label ghx-label-9" href="https://jiraisa.atlassian.net/browse/PAY-1739">
        Flyme BML PGW Implementation
    </a>
</td>
            </tr>
                                <tr>
                <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Sprint:</b></td>
                <td id="customfield_10001-91879-value" class="value" bgcolor="#ffffff" width="80%">PAY Sprint 56, PAY Sprint 58, PAY Sprint 61, PAY Sprint 54, PAY Sprint 57, PAY Sprint 59, PAY Sprint 60, PAY Sprint 55</td>
            </tr>
            </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td id="descriptionArea">
            <p><b>Payment flow</b> </p>

<ol>
	<li>The customer clicks the pay button on IBE</li>
	<li>Send the payment initiation request to payment gateway</li>
</ol>


<p>          <b>Request</b></p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>curl --location --request POST 'https://api.uat.merchants.bankofmaldives.com.mv/public/transactions' \
--header 'Authorization: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHBJZCI6IjYzZGU1ZDU1LTRiYWEtNGM2Yi1iNzBiLWExNGQ4ODNlNGVjNyIsImNvbXBhbnlJZCI6IjYxMmRlZjA1ZTkxMjdjMDAwOWYxNTc4MyIsImlhdCI6MTYzNDU3NDIzOSwiZXhwIjo0NzkwMjQ3ODM5fQ.KjoNR3PPD-AGcNrAfuvUuFU25bx84G9jqML0Lh6h6Oo' \
--header 'Content-Type: application/json' \
--data-raw '{
  "localId": "W50",
  "customerReference": "W50",
  "signature": "a1d7a2027706f2fede541f7bac4531840035a3c0",
  "amount": 2000,
  "currency": "MVR",
  "provider": "",
  "appVersion": "aeroMart_8",
  "apiVersion": "2.0",
  "deviceId": "W50",
  "signMethod": "sha1",
  "redirectUrl": "https://flymecmb2.isaaviations.com"
}'</pre>
</div></div>



<p>               <b>Response</b>                     </p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>{
    "created": "2022-06-27T10:58:14.695Z",
    "updated": "2022-06-27T10:58:14.710Z",
    "amount": 2000,
    "merchantId": "612def05e9127c0009f15783",
    "customerId": null,
    "currency": "MVR",
    "payCurrency": "MVR",
    "provider": null,
    "providerHistory": [],
    "state": "INITIATED",
    "accountingState": null,
    "qr": {},
    "securityWord": "",
    "canRefundIfConfirmed": true,
    "canIncrementalPartialRefundIfConfirmed": true,
    "canPartialRefundIfConfirmed": true,
    "externalImport": false,
    "externalId": "",
    "localId": "W50",
    "paymentToken": null,
    "history": [
        {
            "state": "INITIATED",
            "updatedDate": "2022-06-27T10:58:14.695Z",
            "trigger": "SYSTEM"
        }
    ],
    "appVersion": "aeroMart_8",
    "apiVersion": "2.0",
    "deviceId": "63de5d55-4baa-4c6b-b70b-a14d883e4ec7",
    "originalDeviceId": "63de5d55-4baa-4c6b-b70b-a14d883e4ec7",
    "redirectUrl": "https://flymecmb2.isaaviations.com",
    "costStructure": null,
    "providerDisplayName": null,
    "remittanceId": null,
    "orderInfo": null,
    "originatorApp": "63de5d55-4baa-4c6b-b70b-a14d883e4ec7",
    "refundId": null,
    "refundReason": null,
    "paymentErrorHistory": [],
    "vendorQrCode": null,
    "resellerMetadata": {},
    "subTotal": null,
    "taxesTotal": null,
    "serviceChargeTotal": null,
    "paymentLinks": [],
    "initiator": null,
    "url": "https://transaction.uat.merchants.bankofmaldives.com.mv/62b98d466601500009d081cc",
    "initiatorDetails": null,
    "expires": "2022-07-04T10:58:14.692Z",
    "customerReference": "W50",
    "hasError": false,
    "allowRetry": false,
    "threeDSecure": null,
    "paddedCardNumber": null,
    "providerBrandName": null,
    "buyerIdentifier": null,
    "tokenizationMethod": null,
    "isPreAuthorization": false,
    "isPaymentLink": true,
    "isShop": null,
    "isTapToPay": null,
    "preauthorizedAmount": null,
    "preauthorizedExpiryDate": null,
    "refundExpiryDate": null,
    "fxOrder": null,
    "vendorUrl": null,
    "payAmount": 2000,
    "rating": null,
    "signMethod": "sha1",
    "dcc": null,
    "implicitDcc": null,
    "capturedAmount": null,
    "urlHash": "OgZqonl4Q",
    "shortUrl": "https://uat.pay.bml.com.mv/OgZqonl4Q",
    "orderState": null,
    "orderStateSlug": null,
    "amountBeforeDiscount": null,
    "amountDiscounted": null,
    "isTest": null,
    "cardExpMonth": null,
    "cardExpYear": null,
    "cardFunding": null,
    "cardCountry": null,
    "lastShared": null,
    "availableBalance": 2000,
    "refundTransactions": [],
    "refundTransactionIds": [],
    "parentTransactionId": null,
    "paymentLinkSecurity": null,
    "balanceMigrated": null,
    "refundMigrated": null,
    "oldRefundFlowTransaction": null,
    "refundFlagMigration": null,
    "invoiceInfo": null,
    "availableBalanceMigrated": null,
    "terminalId": null,
    "locationMetadata": null,
    "payerId": null,
    "payerMetaId": null,
    "tenantTermsId": null,
    "merchantTermsId": null,
    "payerIpAddress": null,
    "billingInfoProvidedViaAPI": false,
    "tokenizationDetails": {},
    "id": "62b98d466601500009d081cc",
    "amountAsDecimal": "20.00",
    "amountFormatted": "MVR 20.00"
}</pre>
</div></div>



<p>3. Redirect the customer to <tt>url</tt>   -  sample URL  <tt><a href="https://transaction.uat.merchants.bankofmaldives.com.mv/62b98d466601500009d081cc" class="external-link" rel="nofollow noreferrer">https://transaction.uat.merchants.bankofmaldives.com.mv/62b98d466601500009d081cc</a></tt></p>

<p>               <b>Redirect response</b>               </p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>https://flymecmb2.isaaviations.com/?transactionId=62b98d466601500009d081cc&amp;state=CONFIRMED&amp;signature=a1d7a2027706f2fede541f7bac4531840035a3c0</pre>
</div></div>

<p>4. Process the redirection response </p>

<ol>
	<li>Query the payment status from payment gateway.</li>
</ol>


<p>                 <b>Query Request</b></p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>curl --location --request GET 'https://api.uat.merchants.bankofmaldives.com.mv/public/transactions/62b983eb64da1d00090a28e0' \
--header 'Authorization: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHBJZCI6IjYzZGU1ZDU1LTRiYWEtNGM2Yi1iNzBiLWExNGQ4ODNlNGVjNyIsImNvbXBhbnlJZCI6IjYxMmRlZjA1ZTkxMjdjMDAwOWYxNTc4MyIsImlhdCI6MTYzNDU3NDIzOSwiZXhwIjo0NzkwMjQ3ODM5fQ.KjoNR3PPD-AGcNrAfuvUuFU25bx84G9jqML0Lh6h6Oo'</pre>
</div></div>

<p>              <b>Query Response</b></p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>{
    "id": "62b983eb64da1d00090a28e0",
    "created": "2022-06-27T10:18:19.091Z",
    "updated": "2022-06-27T10:18:19.091Z",
    "amount": 2000,
    "merchantId": "612def05e9127c0009f15783",
    "customerId": null,
    "currency": "MVR",
    "payCurrency": "MVR",
    "provider": "bml_epos",
    "providerHistory": [
        "bml_epos"
    ],
    "state": "CONFIRMED",
    "accountingState": null,
    "qr": {
        "url": "https://qr.uat.merchants.bankofmaldives.com.mv/612def05e9127c0009f15783/transactions/62b983eb64da1d00090a28e0_rykybv1656325099.png"
    },
    "securityWord": "ADORABLE LAPWING",
    "canRefundIfConfirmed": true,
    "canIncrementalPartialRefundIfConfirmed": false,
    "canPartialRefundIfConfirmed": false,
    "externalImport": false,
    "externalId": "062702691946",
    "localId": "W50",
    "paymentToken": "691946",
    "history": [
        {
            "state": "INITIATED",
            "updatedDate": "2022-06-27T10:18:19.091Z",
            "trigger": "SYSTEM"
        },
        {
            "state": "QR_CODE_GENERATED",
            "updatedDate": "2022-06-27T10:18:19.496Z",
            "trigger": "SYSTEM"
        },
        {
            "state": "CONFIRMED",
            "updatedDate": "2022-06-27T10:21:21.188Z",
            "trigger": "VENDOR_WEBHOOK"
        }
    ],
    "appVersion": "aeroMart_8",
    "apiVersion": "2.0",
    "deviceId": "99000988",
    "originalDeviceId": "63de5d55-4baa-4c6b-b70b-a14d883e4ec7",
    "redirectUrl": "https://flymecmb2.isaaviations.com",
    "costStructure": {
        "currency": "MVR",
        "feeRateExact": 50,
        "rateFee": 50,
        "fee": 50,
        "payable": 1950,
        "fixedFee": 0,
        "merchantDiscountRate": {
            "fixedFee": 0,
            "rateFee": 250,
            "code": "MCDEBT",
            "provider": "bml_epos",
            "resellerMetadata": {
                "reseller": "BML",
                "resellerCode": "MCDEBT"
            }
        }
    },
    "providerDisplayName": "bml_epos",
    "remittanceId": null,
    "orderInfo": null,
    "originatorApp": "99000988",
    "refundId": null,
    "refundReason": null,
    "paymentErrorHistory": [],
    "vendorQrCode": null,
    "resellerMetadata": {},
    "subTotal": null,
    "taxesTotal": null,
    "serviceChargeTotal": null,
    "paymentLinks": [],
    "initiator": null,
    "url": "https://transaction.uat.merchants.bankofmaldives.com.mv/62b983eb64da1d00090a28e0",
    "initiatorDetails": null,
    "expires": "2022-07-04T10:18:19.091Z",
    "customerReference": "W50",
    "hasError": false,
    "allowRetry": false,
    "threeDSecure": true,
    "paddedCardNumber": "526431******6566",
    "providerBrandName": "MasterCard Debit",
    "buyerIdentifier": null,
    "tokenizationMethod": null,
    "isPreAuthorization": false,
    "isPaymentLink": true,
    "isShop": null,
    "isTapToPay": null,
    "preauthorizedAmount": null,
    "preauthorizedExpiryDate": null,
    "refundExpiryDate": null,
    "fxOrder": null,
    "vendorUrl": null,
    "payAmount": 2000,
    "rating": null,
    "signMethod": "sha1",
    "dcc": null,
    "implicitDcc": null,
    "capturedAmount": null,
    "urlHash": "VvNlZjoAO",
    "shortUrl": "https://uat.pay.bml.com.mv/VvNlZjoAO",
    "orderState": null,
    "orderStateSlug": null,
    "amountBeforeDiscount": null,
    "amountDiscounted": null,
    "isTest": null,
    "cardExpMonth": null,
    "cardExpYear": null,
    "cardFunding": null,
    "cardCountry": null,
    "lastShared": null,
    "availableBalance": 2000,
    "refundTransactions": [],
    "refundTransactionIds": [],
    "parentTransactionId": null,
    "paymentLinkSecurity": null,
    "balanceMigrated": null,
    "refundMigrated": null,
    "oldRefundFlowTransaction": null,
    "refundFlagMigration": null,
    "invoiceInfo": null,
    "refundWorkflow": null,
    "availableBalanceMigrated": null,
    "terminalId": null,
    "locationMetadata": null,
    "payerId": null,
    "payerMetaId": null,
    "tenantTermsId": "625518c28af33c318c1d20b2",
    "merchantTermsId": null,
    "payerIpAddress": "5.107.201.139",
    "billingInfoProvidedViaAPI": false,
    "tokenizationDetails": {},
    "amountAsDecimal": "20.00",
    "amountFormatted": "MVR 20.00"
}</pre>
</div></div>

<p>2.validate the signature  </p>

<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>if response status is CONFIRMED &amp;&amp; query status is CONFIRMED &amp;&amp; signature is matching
 ===&gt; payment success
 else
 ===&gt; payment fail
</pre>
</div></div>



<p><b>Resources</b> </p>

<p>API details - <a href="https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fbankofmaldives%2Fbml-connect&amp;data=05%7C01%7Cpkarunanayake%40accelaero.com%7C856c797f2450428da07b08da4f578b23%7C7bbb8a4d7f1b4a589b3ac250fb8023e3%7C0%7C0%7C637909534664208412%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=bpj1s7YfNI0DK61GU0qvfeDuPGf%2BCLRQL9Bgm5%2BoR7Y%3D&amp;reserved=0" class="external-link" rel="nofollow noreferrer"><b>https://github.com/bankofmaldives/bml-connect</b></a></p>

<p>Test Api Key: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHBJZCI6IjYzZGU1ZDU1LTRiYWEtNGM2Yi1iNzBiLWExNGQ4ODNlNGVjNyIsImNvbXBhbnlJZCI6IjYxMmRlZjA1ZTkxMjdjMDAwOWYxNTc4MyIsImlhdCI6MTYzNDU3NDIzOSwiZXhwIjo0NzkwMjQ3ODM5fQ.KjoNR3PPD-AGcNrAfuvUuFU25bx84G9jqML0Lh6h6Oo</p>

<p>Test Cards:</p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'>CARD TYPE</td>
<td class='confluenceTd'>MASTERCARD TRAVEL CARD</td>
</tr>
<tr>
<td class='confluenceTd'>CARD NAME</td>
<td class='confluenceTd'>MASTER-01</td>
</tr>
<tr>
<td class='confluenceTd'>CARD NUMBER</td>
<td class='confluenceTd'>5332970608422608</td>
</tr>
<tr>
<td class='confluenceTd'>EXPIRY DATE</td>
<td class='confluenceTd'>09/31</td>
</tr>
<tr>
<td class='confluenceTd'>SECURITY CODE</td>
<td class='confluenceTd'>714</td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'><b>CARD TYPE</b></td>
<td class='confluenceTd'><b>MASTERCARD DEBIT</b></td>
</tr>
<tr>
<td class='confluenceTd'>CARD NAME</td>
<td class='confluenceTd'>MASTER-02</td>
</tr>
<tr>
<td class='confluenceTd'>CARD NUMBER</td>
<td class='confluenceTd'>5264310288096566</td>
</tr>
<tr>
<td class='confluenceTd'>EXPIRY DATE</td>
<td class='confluenceTd'>09/26</td>
</tr>
<tr>
<td class='confluenceTd'>SECURITY CODE</td>
<td class='confluenceTd'>762</td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'><b>CARD TYPE</b></td>
<td class='confluenceTd'><b>MASTERCARD DEBIT</b></td>
</tr>
<tr>
<td class='confluenceTd'>CARD NAME</td>
<td class='confluenceTd'>MASTER-03</td>
</tr>
<tr>
<td class='confluenceTd'>CARD NUMBER</td>
<td class='confluenceTd'>5264310298371686</td>
</tr>
<tr>
<td class='confluenceTd'>EXPIRY DATE</td>
<td class='confluenceTd'>10/26</td>
</tr>
<tr>
<td class='confluenceTd'>SECURITY CODE</td>
<td class='confluenceTd'>003</td>
</tr>
</tbody></table>
</div>




<p><b>aeroMart test systems</b> </p>

<p>CMB - <a href="https://flymecmb2.isaaviations.com/xbe/" class="external-link" rel="nofollow noreferrer">https://flymecmb2.isaaviations.com/</a>service-app/ibe</p>

<p>jenkins CMB <a href="https://jenkins-ci.isaaviations.com/view/aeroMART/job/aeromart-deploy-thinair-vpcmb2/" class="external-link" rel="nofollow noreferrer">https://jenkins-ci.isaaviations.com/view/aeroMART/job/aeromart-deploy-thinair-vpcmb2/</a></p>

<p>SHJ - <a href="https://flyme.isaaviations.com/xbe" class="external-link" rel="nofollow noreferrer">https://flyme.isaaviations.com/xbe</a></p>
            <br/>
        </td>
    </tr>
    </table>

    <br/>

    <table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td bgcolor="#bbbbbb" width="1%" nowrap align="center">
            &nbsp;<font color="#ffffff"><b>Comments</b></font>&nbsp;
        </td>
        <td>&nbsp;</td>
    </tr>
    </table>

    <table cellpadding="0" cellspacing="0" border="0" width="100%" class="grid" style="margin: 0;">
                <tr id="comment-header-121879"><td bgcolor="#f0f0f0">
            Comment by  
                                                    
                
        
            <a class="user-hover" rel="5c3dcd4bc5484b691dd399c5"
                id="word_commented_5c3dcd4bc5484b691dd399c5"
                href="https://jiraisa.atlassian.net/secure/ViewProfile.jspa?accountId=5c3dcd4bc5484b691dd399c5">
                    Pradeep Karunanayaka
                </a>

                                        <font size="-2">
            [
                <font color="#336699">28/Jun/22</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-121879"><td bgcolor="#ffffff">
            <p>development branch 008.0</p>
        </td></tr>
                <tr id="comment-header-121880"><td bgcolor="#f0f0f0">
            Comment by  
                                                    
                
        
            <a class="user-hover" rel="5c3dcd4bc5484b691dd399c5"
                id="word_commented_5c3dcd4bc5484b691dd399c5"
                href="https://jiraisa.atlassian.net/secure/ViewProfile.jspa?accountId=5c3dcd4bc5484b691dd399c5">
                    Pradeep Karunanayaka
                </a>

                                        <font size="-2">
            [
                <font color="#336699">28/Jun/22</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-121880"><td bgcolor="#ffffff">
            <p>Confluence <a href="https://jiraisa.atlassian.net/wiki/spaces/PAY/pages/2153644033/BML+Payment+gateway+integration" title="smart-link" class="external-link" rel="nofollow noreferrer">https://jiraisa.atlassian.net/wiki/spaces/PAY/pages/2153644033/BML+Payment+gateway+integration</a> </p>
        </td></tr>
                <tr id="comment-header-124540"><td bgcolor="#f0f0f0">
            Comment by  
                                                    
                
        
            <a class="user-hover" rel="5c3dcd4bc5484b691dd399c5"
                id="word_commented_5c3dcd4bc5484b691dd399c5"
                href="https://jiraisa.atlassian.net/secure/ViewProfile.jspa?accountId=5c3dcd4bc5484b691dd399c5">
                    Pradeep Karunanayaka
                </a>

                                        <font size="-2">
            [
                <font color="#336699">04/Aug/22</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-124540"><td bgcolor="#ffffff">
            <p>QA Note -  Test URL <a href="https://flymecmb2.isaaviations.com/service-app/ibe" class="external-link" rel="nofollow noreferrer">https://flymecmb2.isaaviations.com/service-app/ibe</a></p>

<p>Supported channels : IBE</p>

<p>Limitation : refund/reversal not support </p>
        </td></tr>
                <tr id="comment-header-124556"><td bgcolor="#f0f0f0">
            Comment by  
                                                    
                
        
            <a class="user-hover" rel="62a314ad1be00a0068af4242"
                id="word_commented_62a314ad1be00a0068af4242"
                href="https://jiraisa.atlassian.net/secure/ViewProfile.jspa?accountId=62a314ad1be00a0068af4242">
                    Kanishka malpana
                </a>

                                        <font size="-2">
            [
                <font color="#336699">05/Aug/22</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-124556"><td bgcolor="#ffffff">
            <p>please find the DB details below</p>

<p>username-FLYME_USER</p>

<p>password-passw0rd</p>

<p>hostname-10.20.4.11</p>

<p>port-1521</p>

<p>SID-ISACMBDB</p>
        </td></tr>
                <tr id="comment-header-124639"><td bgcolor="#f0f0f0">
            Comment by  
                                                    
                
        
            <a class="user-hover" rel="5d6ba34e081fdf0db6e872fa"
                id="word_commented_5d6ba34e081fdf0db6e872fa"
                href="https://jiraisa.atlassian.net/secure/ViewProfile.jspa?accountId=5d6ba34e081fdf0db6e872fa">
                    scelin
                </a>

                                        <font size="-2">
            [
                <font color="#336699">08/Aug/22</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-124639"><td bgcolor="#ffffff">
            <p>Verified Create Flow in stage 3 <a href="https://flymecmb2.isaaviations.com/service-app/ibe" title="smart-link" class="external-link" rel="nofollow noreferrer">https://flymecmb2.isaaviations.com/service-app/ibe</a> </p>

<p>Only IBE is checked that too Create Flow,<br/>
Modify flow etc could not be tested as Modify reservation not available.</p>

<p>Details are checked in Dashboard </p>

<p>URL: <a href="https://dashboard.uat.merchants.bankofmaldives.com.mv/" title="smart-link" class="external-link" rel="nofollow noreferrer">https://dashboard.uat.merchants.bankofmaldives.com.mv/</a> </p>

<p>Email: <a href="mailto:mtarafdar@isa.ae" class="external-link" rel="nofollow noreferrer">mtarafdar@isa.ae</a><br/>
Password: Fq8s0u14Emo160z</p>

<p>Status of the reservation is I-&gt;PS-&gt;PS-&gt;RS</p>

<p><span class="image-wrap" style=""><img src="/secure/attachment/91947/91947_image-20220808-104115.png" height="720" width="1280" style="border: 0px solid black" /></span></p>

<p><span class="image-wrap" style=""><img src="/secure/attachment/91948/91948_image-20220808-104125.png" height="720" width="1280" style="border: 0px solid black" /></span></p>
        </td></tr>
                <tr id="comment-header-126944"><td bgcolor="#f0f0f0">
            Comment by  
                                                    
                
        
            <a class="user-hover" rel="62a314ad1be00a0068af4242"
                id="word_commented_62a314ad1be00a0068af4242"
                href="https://jiraisa.atlassian.net/secure/ViewProfile.jspa?accountId=62a314ad1be00a0068af4242">
                    Kanishka malpana
                </a>

                                        <font size="-2">
            [
                <font color="#336699">06/Sep/22</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-126944"><td bgcolor="#ffffff">
            <p>please test using following</p>

<p><a href="https://flyme.isaaviations.com/service-app/ibe" title="smart-link" class="external-link" rel="nofollow noreferrer">https://flyme.isaaviations.com/service-app/ibe</a> </p>

<p>environment </p>
        </td></tr>
                <tr id="comment-header-127250"><td bgcolor="#f0f0f0">
            Comment by  
                                                    
                
        
            <a class="user-hover" rel="5d6ba34e081fdf0db6e872fa"
                id="word_commented_5d6ba34e081fdf0db6e872fa"
                href="https://jiraisa.atlassian.net/secure/ViewProfile.jspa?accountId=5d6ba34e081fdf0db6e872fa">
                    scelin
                </a>

                                        <font size="-2">
            [
                <font color="#336699">12/Sep/22</font>

                            ]
            </font>

        </td></tr>
        <tr id="comment-body-127250"><td bgcolor="#ffffff">
            <p>NB: Testing is completed and only Bug fix needs to be done for this Jira <br/>
Verified in IBE <a href="https://flyme.isaaviations.com/service-app/ibe" title="smart-link" class="external-link" rel="nofollow noreferrer">https://flyme.isaaviations.com/service-app/ibe</a> </p>

<p>1.Create Flow - Verified</p>

<p>2.Modify Flow - Option Not Available </p>

<p>3. Balance Payment - Issue with Payment Option availability</p>

<p>4.Cancel Payment - Verified</p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'>Own</td>
<td class='confluenceTd'>Booking</td>
<td class='confluenceTd'>3ds VISA</td>
<td class='confluenceTd'>GSP0K9</td>
</tr>
<tr>
<td class='confluenceTd'>Own</td>
<td class='confluenceTd'>On-hold booking</td>
<td class='confluenceTd'>3ds VISA</td>
<td class='confluenceTd'>CD1OYR</td>
</tr>
<tr>
<td class='confluenceTd'>Own</td>
<td class='confluenceTd'>Add segment</td>
<td class='confluenceTd'>3ds VISA</td>
<td class='confluenceTd'>Modification Not enabled</td>
</tr>
<tr>
<td class='confluenceTd'>Own</td>
<td class='confluenceTd'>Change departure date</td>
<td class='confluenceTd'>3ds VISA</td>
<td class='confluenceTd'>Modification Not enabled</td>
</tr>
<tr>
<td class='confluenceTd'>Own</td>
<td class='confluenceTd'>Name change</td>
<td class='confluenceTd'>3ds VISA</td>
<td class='confluenceTd'>Modification Not enabled</td>
</tr>
<tr>
<td class='confluenceTd'>Own</td>
<td class='confluenceTd'>On-hold-Payment--Change Departure date</td>
<td class='confluenceTd'>3ds VISA</td>
<td class='confluenceTd'>PAY-1827</td>
</tr>
<tr>
<td class='confluenceTd'>Own</td>
<td class='confluenceTd'>Payment with CC1 and Modification with CC2</td>
<td class='confluenceTd'>3ds VISA</td>
<td class='confluenceTd'>TVP7LT</td>
</tr>
<tr>
<td class='confluenceTd'>Own</td>
<td class='confluenceTd'>Booking in IBE and modification in xbe--with diff CC</td>
<td class='confluenceTd'>3ds VISA</td>
<td class='confluenceTd'>NA</td>
</tr>
<tr>
<td class='confluenceTd'>Own</td>
<td class='confluenceTd'>Booking</td>
<td class='confluenceTd'>3ds Master</td>
<td class='confluenceTd'>LEK647</td>
</tr>
<tr>
<td class='confluenceTd'>Own</td>
<td class='confluenceTd'>On-hold booking</td>
<td class='confluenceTd'>3ds Master</td>
<td class='confluenceTd'>PAY-1827</td>
</tr>
<tr>
<td class='confluenceTd'>Own</td>
<td class='confluenceTd'>Add segment</td>
<td class='confluenceTd'>3ds Master</td>
<td class='confluenceTd'>Modification Not enabled</td>
</tr>
<tr>
<td class='confluenceTd'>Own</td>
<td class='confluenceTd'>Change departure date</td>
<td class='confluenceTd'>3ds Master</td>
<td class='confluenceTd'>Modification Not enabled</td>
</tr>
<tr>
<td class='confluenceTd'>Own</td>
<td class='confluenceTd'>Name change</td>
<td class='confluenceTd'>3ds Master</td>
<td class='confluenceTd'>Modification Not enabled</td>
</tr>
<tr>
<td class='confluenceTd'>Own</td>
<td class='confluenceTd'>On-hold-Payment--Change Departure date</td>
<td class='confluenceTd'>3ds Master</td>
<td class='confluenceTd'>PAY-1827</td>
</tr>
<tr>
<td class='confluenceTd'>Own</td>
<td class='confluenceTd'>Payment with CC1 and Modification with CC2</td>
<td class='confluenceTd'>3ds Master</td>
<td class='confluenceTd'>PAY-1827</td>
</tr>
</tbody></table>
</div>

        </td></tr>
            </table>
Generated at Sat Oct 15 07:20:13 UTC 2022 by Kanishka malpana using Jira 1001.0.0-SNAPSHOT#100208-sha1:492d0cefef9f66dd63f17aa83f82f65cbabce1dc.

</body>
</html>